---
title: Iteratorå’Œfor...of
date: 2022-10-11
tags:
 - es6
categories:
 -  es6
---     
##  å¼•å…¥    
+ æœ¬æ–‡æ‘˜è‡ª    
    [](https://www.bookstack.cn/read/es6-3rd/spilt.2.docs-iterator.md)      

##  Iteratorå’Œfor...of        

1. ES6 è§„å®šï¼Œé»˜è®¤çš„ `Iterator` æ¥å£éƒ¨ç½²åœ¨æ•°æ®ç»“æ„çš„`Symbol.iterator`å±æ€§ï¼Œæˆ–è€…è¯´ï¼Œä¸€ä¸ªæ•°æ®ç»“æ„åªè¦å…·æœ‰`Symbol.iterator`å±æ€§ï¼Œå°±å¯ä»¥è®¤ä¸ºæ˜¯â€œå¯éå†çš„â€ï¼ˆ`iterable`ï¼‰   
    ```js       
        let arr = ['a', 'b', 'c'];
        let iter = arr[Symbol.iterator]();
        iter.next() // { value: 'a', done: false }
        iter.next() // { value: 'b', done: false }
        iter.next() // { value: 'c', done: false }
        iter.next() // { value: undefined, done: true }
    ```   
2. åŸç”Ÿå…·å¤‡ Iterator æ¥å£çš„æ•°æ®ç»“æ„å¦‚ä¸‹   
    + Map Set String  Array  TypedArray  å‡½æ•°çš„argumentså¯¹è±¡   NodeListå¯¹è±¡   
    + æœ¬è´¨ä¸Šï¼Œéå†å™¨æ˜¯ä¸€ç§çº¿æ€§å¤„ç†ï¼Œå¯¹äºä»»ä½•éçº¿æ€§çš„æ•°æ®ç»“æ„ï¼Œéƒ¨ç½²éå†å™¨æ¥å£ï¼Œå°±ç­‰äºéƒ¨ç½²ä¸€ç§çº¿æ€§è½¬æ¢.æ‰€ä»¥å¯¹è±¡æ²¡æœ‰é»˜è®¤éƒ¨ç½² Iterator æ¥å£   

3. è°ƒç”¨ Iterator æ¥å£çš„åœºåˆ   
    + è§£æ„èµ‹å€¼    
    + æ‰©å±•è¿ç®—ç¬¦    
    + yield*    
    + å…¶ä»–åœºåˆï¼ˆforâ€¦of   Array.from()  Map(), Set(), WeakMap(), WeakSet()ï¼ˆæ¯”å¦‚new Map([['a',1],['b',2]])ï¼‰ï¼‰  Promise.all()  Promise.race()  ï¼‰    
4. ä¿®æ”¹é»˜è®¤çš„iteratoræ¥å£   
    ```js     
          let str = new String('4522688899')
          str[Symbol.iterator] = function () {
            return {
              index: 0,
              next: function () {
                return this.index < str.length ? {
                  value: str[this.index++] + 1,
                  done: false
                } : {
                  done: true
                }
              },
            };
          };
          console.log([...str]);  //["41", "51", "21", "21", "61", "81", "81", "81", "91", "91"]
    ```       
##  for...ofä¸for...in      
1.  for...inå¾ªç¯è¯»å–é”®åï¼Œfor...ofå¾ªç¯è¯»å–é”®å€¼ã€‚å¦‚æœè¦é€šè¿‡for...ofå¾ªç¯ï¼Œè·å–æ•°ç»„çš„ç´¢å¼•ï¼Œå¯ä»¥å€ŸåŠ©æ•°ç»„å®ä¾‹çš„entriesæ–¹æ³•å’Œkeysæ–¹æ³•   
    ```js     
        var arr = ['a', 'b', 'c', 'd']; 
        let obj = {
              'a': 111,
              'b': 221,
              '0': 555,
              1.1: 666,
                2: 777,
              'c': 331,
            }
        for (let key in obj) {
          console.log(key); // "0","2","a","b","1.1","c"
        }
        for (let a in arr) {
          console.log(a); // 0 1 2 3
        }
        for (let a of arr) {
          console.log(a); // a b c d
        }
    ```     
2. for...ofå¾ªç¯è°ƒç”¨éå†å™¨æ¥å£ï¼Œ**æ•°ç»„çš„éå†å™¨æ¥å£åªè¿”å›å…·æœ‰æ•°å­—ç´¢å¼•çš„å±æ€§**ã€‚è¿™ä¸€ç‚¹è·Ÿfor...inå¾ªç¯ä¹Ÿä¸ä¸€æ ·   
    ```js   
        let arr = [3, 5, 7];
          arr.foo = 'hello';
          for (let i in arr) {
            console.log(i); // "0", "1", "2", "foo"
          }
          for (let i of arr) {
            console.log(i); //  "3", "5", "7"
          }
    ```   
3. Set å’Œ Map ç»“æ„ä¹ŸåŸç”Ÿå…·æœ‰ Iterator æ¥å£ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨for...ofå¾ªç¯ã€‚Set ç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªå€¼ï¼Œè€Œ Map ç»“æ„éå†æ—¶ï¼Œè¿”å›çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥æ•°ç»„çš„ä¸¤ä¸ªæˆå‘˜åˆ†åˆ«ä¸ºå½“å‰ Map æˆå‘˜çš„é”®åå’Œé”®å€¼ã€‚    

##  è®¡ç®—ç”Ÿæˆçš„æ•°æ®ç»“æ„    
1. `entries()` è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†[é”®å, é”®å€¼]ç»„æˆçš„æ•°ç»„ã€‚å¯¹äºæ•°ç»„ï¼Œé”®åå°±æ˜¯ç´¢å¼•å€¼ï¼›å¯¹äº Setï¼Œé”®åä¸é”®å€¼ç›¸åŒã€‚**Map ç»“æ„çš„ Iterator æ¥å£ï¼Œé»˜è®¤å°±æ˜¯è°ƒç”¨`entries`æ–¹æ³•**ã€‚      
2. `keys()` è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®åã€‚      
3. `values()` è¿”å›ä¸€ä¸ªéå†å™¨å¯¹è±¡ï¼Œç”¨æ¥éå†æ‰€æœ‰çš„é”®å€¼ã€‚      
    ```js   
         let arr = ['a', 'b', 'c'];
          arr.foo = 11
          for (let pair of arr.entries()) {
            console.log(pair);
          }
          // [0, 'a']
          // [1, 'b']
          // [2, 'c']   
    ```   
4. å¯¹äºå­—ç¬¦ä¸²æ¥è¯´ï¼Œfor...ofå¾ªç¯è¿˜æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯ä¼šæ­£ç¡®è¯†åˆ« 32 ä½ UTF-16 å­—ç¬¦   
    ```js   
        for (let x of 'a\uD83D\uDC0A') {
          console.log(x);
        }
        // 'a'
        // 'ğŸŠ'  
    ```   
5.  å¯¹äºæ™®é€šçš„å¯¹è±¡ï¼Œfor...ofç»“æ„ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œä¼šæŠ¥é”™ï¼Œå¿…é¡»éƒ¨ç½²äº† Iterator æ¥å£åæ‰èƒ½ä½¿ç”¨.   
  + ä¸€ç§è§£å†³æ–¹æ³•æ˜¯ï¼Œä½¿ç”¨Object.keysæ–¹æ³•å°†å¯¹è±¡çš„é”®åç”Ÿæˆä¸€ä¸ªæ•°ç»„ï¼Œç„¶åéå†è¿™ä¸ªæ•°ç»„    
    ```js     
          let someObject = {
            edition: 6,
            committee: "TC39",
            standard: "ECMA-262"
          };
          for (var key of Object.keys(someObject)) {
            console.log(key + ': ' + someObject[key]);      //edition: 6  
          }                                                 //committee: TC39
                                                            //standard: ECMA-262    
    ```       
  + å¦ä¸€ä¸ªæ–¹æ³•æ˜¯ä½¿ç”¨ Generator å‡½æ•°å°†å¯¹è±¡é‡æ–°åŒ…è£…ä¸€ä¸‹ã€‚   
    ```js   
        function* entries(obj) {
          for (let key of Object.keys(obj)) {
            yield [key, obj[key]];
          }
        }
        for (let [key, value] of entries(obj)) {
          console.log(key, '->', value);
        }
        // a -> 1
        // b -> 2
        // c -> 3
    ```       
##    ä¸å…¶ä»–éå†è¯­æ³•çš„æ¯”è¾ƒ    
1. ä»¥æ•°ç»„ä¸ºä¾‹ï¼Œ`JavaScript` æä¾›å¤šç§éå†è¯­æ³•ã€‚æœ€åŸå§‹çš„å†™æ³•å°±æ˜¯`for`å¾ªç¯,å†™æ³•æ¯”è¾ƒéº»çƒ¦.   
2. å› æ­¤æ•°ç»„æä¾›å†…ç½®çš„`forEach`æ–¹æ³•,è¿™ç§å†™æ³•çš„é—®é¢˜åœ¨äºï¼Œæ— æ³•ä¸­é€”è·³å‡º`forEach`å¾ªç¯ï¼Œ`break`å‘½ä»¤æˆ–`return`å‘½ä»¤éƒ½ä¸èƒ½å¥æ•ˆ   
3. `for...in`å¾ªç¯å¯ä»¥éå†æ•°ç»„çš„é”®å   
    + æ•°ç»„çš„é”®åæ˜¯æ•°å­—ï¼Œä½†æ˜¯`for...in`å¾ªç¯æ˜¯ä»¥å­—ç¬¦ä¸²ä½œä¸ºé”®åâ€œ0â€ã€â€œ1â€ã€â€œ2â€ç­‰ç­‰   
    + `for...in`å¾ªç¯ä¸ä»…éå†æ•°å­—é”®åï¼Œè¿˜ä¼šéå†æ‰‹åŠ¨æ·»åŠ çš„å…¶ä»–é”®ï¼Œç”šè‡³åŒ…æ‹¬åŸå‹é“¾ä¸Šçš„é”®    
    + æŸäº›æƒ…å†µä¸‹ï¼Œ`for...in`å¾ªç¯ä¼šä»¥ä»»æ„é¡ºåºéå†é”®å    
    + æ€»ä¹‹ï¼Œ`for...in`å¾ªç¯ä¸»è¦æ˜¯ä¸ºéå†å¯¹è±¡è€Œè®¾è®¡çš„ï¼Œä¸é€‚ç”¨äºéå†æ•°ç»„    
4. `for...of`å¾ªç¯ç›¸æ¯”ä¸Šé¢å‡ ç§åšæ³•ï¼Œæœ‰ä¸€äº›æ˜¾è‘—çš„ä¼˜ç‚¹   
    + æœ‰ç€åŒ`for...in`ä¸€æ ·çš„ç®€æ´è¯­æ³•ï¼Œä½†æ˜¯æ²¡æœ‰`for...in`é‚£äº›ç¼ºç‚¹    
    + ä¸åŒäº`forEach`æ–¹æ³•ï¼Œå®ƒå¯ä»¥ä¸`break`ã€`continue`å’Œ`return`é…åˆä½¿ç”¨    
    + æä¾›äº†éå†æ‰€æœ‰æ•°æ®ç»“æ„çš„ç»Ÿä¸€æ“ä½œæ¥å£    
      ```js     
          for (var n of fibonacci) {
            if (n > 1000)
              break;
            console.log(n);
          }  
      ```     