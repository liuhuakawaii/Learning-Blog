---
title: wheel事件和scroll事件
date: 2023-7-25
tags:
 - js
categories:
 -  踩坑
--- 

## wheel事件和scroll事件

+ 前段时间因为需求原因，封装了一个XScroll组件，用于水平滚动元素的展示，但是出现了一个问题：对于笔记本设备的触摸板双指滚动的时候有问题
+ 因为XScroll是通过将垂直的盒子通过transform水平展示了，所以我们在使用鼠标滚轮上下滚动的时候实际上是元素变换前的上下滑动，视觉效果上给人一种左右滑动的感觉
+ 但是在触摸板双指滚动的时候，我们在此处想要双指左右滑动来实现左右滑动，是不行的，因为实际上是双指上下滑动才能触发
+ 为了实现这个需求，我查阅了wheel事件和scroll的区别和联系 

### **wheel事件**   
1. wheel事件是用于检测鼠标滚轮滚动的事件。它通常在以下情况下被触发：
    + 用户使用鼠标滚轮滚动时；
    + 用户通过触摸板操作模拟鼠标滚轮滚动时；
    + 用户点击滚动条上方或下方的按钮时；
    + 用户使用键盘上的 PageUp、PageDown、Home、End 等键来模拟滚动。
    + 需要注意的是，wheel事件还可以检测到一些滚动模拟设备（如触控笔），以及其他设备的滚动操作（如触摸屏上的滑动手势等）
2. wheel事件的事件对象包含以下常见属性和方法：
    + event.deltaX：鼠标滚轮在水平方向上滚动的距离。
    + event.deltaY：鼠标滚轮在垂直方向上滚动的距离
    + event.deltaZ：鼠标滚轮在 Z 轴方向上滚动的距离。
    + event.deltaMode：滚动的单位。常见的值有：0 表示像素单位，1 表示行单位，2 表示页单位。
    + event.preventDefault()：阻止浏览器的默认滚动行为。

### **scroll事件**
1. scroll事件的事件对象没有特定的常见属性或方法，但是可以使用其他属性和方法来获取和处理滚动相关的信息
    + element.scrollTop：元素的垂直滚动位置。
    + element.scrollLeft：元素的水平滚动位置。
    + element.scrollHeight：元素内容的完整高度。
    + element.scrollWidth：元素内容的完整宽度。
2. 需要注意的是，scroll事件在滚动时会频繁触发，因此建议在处理该事件时优化代码性能，避免频繁的计算和操作。

### **联系与区别**
1. 触发顺序上，一般情况下，当用户使用鼠标滚轮滚动时，wheel事件会先于scroll事件触发。但也有一些特殊情况，比如在某些浏览器中，scroll事件可能在wheel事件之前触发，或者某些情况下可能只触发其中一个事件。
2. wheel事件在鼠标和触摸板触发的时候也会有所不一样
    + 首先鼠标滚轮触发直接改变的是`event.deltaY`，触摸板双指左右滑动和上下滑动分别改变的是`event.deltaX`和`event.deltalY`
    + 我的鼠标设备改变`deltaY`单次触发是150，而触摸板则要小很多并且触发频率高，所以很多博客使用以下代码写水平滚动会让人感觉很卡顿
    ```js
           box.addEventListener('wheel', (e) => {
              e.currentTarget.scrollLeft += e.deltaY;
            })
    ```
3. 如果你在wheel事件中去改变了scrollTop等值，会导致scroll事件就不触发了
4. 针对以上问题，优化了一下之前的XScroll的问题，并且增加了触摸屏，触摸板滚动的优化